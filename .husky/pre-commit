# Check if package-lock.json is in sync with package.json
echo "üîç Checking if package-lock.json is in sync with package.json..."
npm install --package-lock-only --dry-run > /dev/null 2>&1
if [ $? -ne 0 ]; then
  echo "‚ùå ERROR: Your package-lock.json is out of sync with package.json!"
  echo ""
  echo "Please run the following commands and try again:"
  echo "  1. rm -rf package-lock.json node_modules"
  echo "  2. npm install"
  echo "  3. git add package-lock.json"
  echo ""
  exit 1
fi
echo "‚úÖ Lockfile is in sync"

# Run lint-staged for code quality checks
npx --no-install lint-staged || echo "Lint-staged failed, please fix linting errors"

# Run tests to ensure nothing is broken
npm test || echo "Tests failed, please fix failing tests"
